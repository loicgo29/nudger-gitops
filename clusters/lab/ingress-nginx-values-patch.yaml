apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: helm-ingress-nginx
  namespace: ns-ingress-nginx
spec:
  timeout: 10m
  values:
    admissionWebhooks:
      enabled: false
    controller:
      extraVolumes:
        - name: nginx-run
          emptyDir: {}
        - name: nginx-cache
          emptyDir: {}
      extraVolumeMounts:
        - name: nginx-run
          mountPath: /var/run
        - name: nginx-cache
          mountPath: /var/cache/nginx
      containerSecurityContext:
        readOnlyRootFilesystem: false
      podLabels:
        security.nudger/allow-rw-rootfs: "true"
      podAnnotations:
        security.nudger/justification: "NGINX needs /var/run & cache write access"
