apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: helm-ingress-nginx
  namespace: ns-ingress-nginx
spec:
  timeout: 10m
  values:
    controller:
      admissionWebhooks:
        enabled: false
      extraVolumes:
        - name: nginx-run
          emptyDir: {}
        - name: nginx-cache
          emptyDir: {}
      extraVolumeMounts:
        - name: nginx-run
          mountPath: /var/run
        - name: nginx-cache
          mountPath: /var/cache/nginx
      containerSecurityContext:
        readOnlyRootFilesystem: true
      podLabels:
        security.nudger/allow-rw-rootfs: "true"
      podAnnotations:
        security.nudger/justification: "NGINX controller nécessite écriture (/var/log/nginx, /tmp)"
