apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: ns-open4goods-recette

resources:
  - ../../base
patches:
  - target:
      kind: HelmRelease
      name: xwiki
    patch: |
      - op: replace
        path: /spec/values/mysql/enabled
        value: false
      - op: replace
        path: /spec/values/mariadb/enabled
        value: false
      - op: replace
        path: /spec/values/postgresql/enabled
        value: false
      - op: replace
        path: /spec/values/externalDB
        value:
          type: mysql
          host: mysql-xwiki.ns-open4goods-recette.svc.cluster.local
          user: xwiki
          database: xwiki
          customKeyRef:
            enabled: true
            name: mysql-xwiki
            key: mysql-password
